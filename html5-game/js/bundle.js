!function(a){a.fn.getNumbByPx=function(e){var i=a(this).css(e),t=i.length;return Number(i.slice(0,t-2))},a.fn.disable=function(){return this.each(function(){a(this).hasClass("active")&&a(this).removeClass("active"),a(this).addClass("disable")})},a.fn.active=function(e){return this.each(function(){a(this).hasClass("disable")&&a(this).removeClass("disable"),e?a(this).addClass("active"):a(this).removeClass("active")})},a.fn.scale=function(e){return a(this).filter(":visible").length||1==e?(a(this).parent().hasClass("scaleContainer")||(a(this).wrap(a('<div class="scaleContainer">').css("position","relative")),a(this).data({originalWidth:a(window).width(),originalHeight:a(window).height()})),a(this).css({transform:"scale("+e+")","-ms-transform":"scale("+e+")","-moz-transform":"scale("+e+")","-webkit-transform":"scale("+e+")","transform-origin":"0 0","-ms-transform-origin":"0 0","-moz-transform-origin":"0 0","-webkit-transform-origin":"0 0"}),1==e?a(this).unwrap().css("position","static"):a(this).parent().width(a(this).data("originalWidth")).height(a(this).data("originalHeight")),a(this)):a(this)}}(jQuery);var N=0,App=function(a){return a.Log.enable=!1,a.jsonKH=!1,a.Variables.figure=$(".player"),a.Variables.map.bg=$(".bg--map"),a}((App=function(a){return a.Services={},a.Services.getNumberRandomBetween=function(a,e){return e=e||0,Math.floor(Math.random()*a)+e},a.Services.UpdateQuestion=function(e){e.data.game_answers.forEach(function(a){"boolean"!=typeof a.extend&&("true"==a.extend?a.extend=!0:a.extend=!1)});for(var i=0;i<e.data.game_answers.length;i++)if(e.data.game_answers[i].extend){e.data.game_answers[i].description[0];break}var t="";e.data.game_question.value.split(" ").forEach(function(a){if(-1!=a.search('"')){var e=a.split('"');t+='"<span style="color: red;">'+e[1]+'</span>" '}else t+=a+" "}),$("#question").html(t),a.Variables.Data._listR=e.data.game_answers.filter(function(a){return a.extend}),a.Variables.Data._listW=e.data.game_answers.filter(function(a){return!a.extend}),this.UpdateAnswer(a.Variables.Data._listR,a.Variables.Data._listW)},a.Services.setAnswer=function(a,e){0==a&&(a=3),$("#Answer"+a+" img").attr("src",App.Services.getUrlById(e.id)),$("#Answer"+a+" p").text(e.description),$("#Answer"+a+" p").attr("attr",e.id),$("#Answer"+a).removeClass("bg--true"),e.extend?($("#Answer"+a).addClass("run"),$("#Answer"+a).removeClass("btn-fail")):($("#Answer"+a).removeClass("run"),$("#Answer"+a).addClass("btn-fail"))},a.Services.UpdateAnswer=function(e,i){if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),$(".run").unbind("click"),$(".btn-fail").unbind("click"),0!=e.length){var t=1;e.length>1&&a.Variables.map.count_box<10&&(t=1),App.Variables.N=t;var r=a.Services.getNumberRandomBetween(3,1);a.Log.w(t,"number of ans"),1==t?(a.Services.spliceArr(r%3,e),a.Services.spliceArr((r+1)%3,i),a.Services.spliceArr((r+2)%3,i),a.Log.w(i,"list W")):2==t&&(a.Services.spliceArr(r%3,i),a.Services.spliceArr((r+1)%3,e),a.Services.spliceArr((r+2)%3,e),a.Log.w(i,"list R")),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?($(".run").on("click",runClick),$(".btn-fail").on("click",btnFailClick)):($(".run").one("click",runClick),$(".btn-fail").one("click",btnFailClick))}},a.Services.UpdateLearn=function(){if(null!=a.Variables.Data._data){for(var e="",i=0;i<a.Variables.Data._data.data.game_answers.length;i++)e=e.concat('<div class="col-25 col"><div class="bg--learn__item"><img src="'+App.Services.getUrlById(a.Variables.Data._data.data.game_answers[i].id)+'" alt=""><p attr="'+a.Variables.Data._data.data.game_answers[i].id+'">'+a.Variables.Data._data.data.game_answers[i].description+"</p></div></div>");e+='<div class="clearfix"></div>',$(".bg--learn__list-item").html(e)}},a.Services.registerSound=function(a,e){null!=a&&createjs.Sound.registerSound(a,e)},a.Services.registerAllSound=function(e){e.data.game_background_music.forEach(function(e){e.word,a.Services.registerSound(e.voice,e.id)}),e.data.game_answers.forEach(function(e){a.Services.registerSound(e.voice,e.id)})},a.Services.playSound=function(a,e){var i=createjs.Sound.play(a);i.volume="jump"==a?.1:1,e&&e(i)},a.Services.spliceArr=function(e,i){var t=a.Services.getNumberRandomBetween(i.length-1,0);this.setAnswer(e,i[t]),i.splice(t,1)},a.Services.isMobile=function(){return a.Variables.width_window<=995},a.Services.getParameterByName=function(a,e){e||(e=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null},a.Services.GetObjectFromUrl=function(){var a=document.URL,e=App.Services.getParameterByName("exercise_id",a),i=App.Services.getParameterByName("token",a);return{username:App.Services.getParameterByName("username",a),token:i,exerciseid:e}},a.Services.getDataRes=function(e,i){if(App.jsonKH){var t=a.Services.GetObjectFromUrl();App.Http.postHeaders(a.Constants.linkData,t,function(a){App.Log.w(a,"DATA"),e("object"==typeof a?a:JSON.parse(a))},function(a){App.Log.w(a,"ERR"),i(a)})}else App.Http.get(a.Constants.linkData0,function(a){App.Log.w(a,"DATA"),e("object"==typeof a?a:JSON.parse(a))},function(a){App.Log.w(a,"ERR"),i(a)})},a.Services.bindEvent=function(a,e,i){a.addEventListener?a.addEventListener(e,i,!1):a.attachEvent&&a.attachEvent("on"+e,i)},a.Services.sendMessage=function(a){window.parent.postMessage(a,"*")},a.Services.getUrlById=function(a){var e=App.Variables.preload.getResult(a,!0);if(null!=e){var i=window.URL||window.webkitURL;e instanceof Blob&&(e=i.createObjectURL(e))}return e},a}((App=function(a){return a.Constants={},a.Constants.linkData0="./js/data.json",a.Constants.linkData="https://api.edupia.vn/service/exerciseinfo",a.Constants.upPoint="https://api.edupia.vn/service/uppoint",a}((App=function(a){return a.Http={},a.Http.post=function(a,e,i,t){$.ajax({url:a,data:e,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:i,failure:t})},a.Http.postHeaders=function(a,e,i,t){$.ajax({url:a,headers:e,type:"POST",dataType:"json",contentType:"application/json; charset=utf-8",success:i,failure:t})},a.Http.get=function(a,e,i){$.ajax({url:a,type:"GET",success:e,failure:i})},a}((App=function(a){return a.Log={enable:!1},a.Log.isEnabled=function(){return this.enable},a.Log.write=function(a,e){var i=e||"Default Logging";this.enable&&(console.log("---BEGIN "+i+"---"),console.log(a),console.log("---END "+i+"---"))},a.Log.writeString=function(a,e){var i=e||"Log Tag: ";this.enable&&console.log(i+" : "+a)},a.Log.writeMethod=function(a){this.enable&&console.log("[ Method Logging ] ---"+a+"()")},a.Log={w:a.Log.write,ws:a.Log.writeString,m:a.Log.writeMethod},a}((App=function(a){return a.Variables={},a.Variables.preload=null,a.Variables.N=0,a.Variables.isStartAll=!1,a.Variables.map={count_box:1,box:10,bg:""},a.Variables.load={},a.Variables.load.animationstart=$("#load"),a.Variables.load.process=$("#process"),a.Variables.load.span=a.Variables.load.animationstart.children("span"),a.Variables.sound={count_sound:0},a.Variables.bg_sound=null,a.Variables.setInterval={event_listen:"",load_percent:"",time:1},a.Variables.screen=996,a.Variables.audio_learn,a.Variables.Data={_data:"",_listR:"",_listW:""},a.Variables.rnd,a.Variables.figure,a.Variables.width_window=$(window).width(),a.Variables.learn_item,a.Variables.question=$(".bg--question__item"),a}(App||{}))||{}))||{}))||{}))||{}))||{}),mainsound=null,messageFromIframe="";document.documentElement.addEventListener("gesturestart",function(a){a.preventDefault()},!1),$.ajaxSetup({crossOrigin:!0});var ishover=[!1,!1,!1];function preloadResource(){App.Variables.preload=new createjs.LoadQueue,App.Variables.preload.installPlugin(createjs.Sound);var a=new createjs.LoadQueue;App.Variables.preload.next=a,App.Variables.preloadVideo=a,App.Variables.preloadVideo.on("complete",function(a){App.Variables.load.span.text("100%"),App.Variables.load.process.css("width","100%"),initAll(),$(".bg--play__btn").active(0),$(".bg--play__load").disable(),App.Services.playSound(App.Variables.Data._data.data.game_background_music[0].id,function(a){mainsound=a})},this),App.Variables.preload.on("progress",function(a){App.Variables.load.span.text(Math.floor(.9*a.progress*100)+"%"),App.Variables.load.process.css("width",Math.floor(.9*a.progress*100)+"%")},this),$("#wrapper").css("background","url("+App.Variables.Data._data.data.game_background[3].images+") no-repeat bottom center"),$(".bg--play__img").css("background-image","url("+App.Variables.Data._data.data.game_background[0].images+")");var e=App.Variables.Data._data.data.game_box;App.Variables.preload.loadFile({id:e.id,src:e.images},!1);var i=App.Variables.Data._data.data.game_questionbox;App.Variables.preload.loadFile({id:i.id,src:i.images},!1),App.Variables.Data._data.data.game_character.forEach(function(a){App.Variables.preload.loadFile({id:a.id,src:a.images},!1)}),App.Variables.Data._data.data.game_background.forEach(function(a){App.Variables.preload.loadFile({id:a.id,src:a.images},!1)}),App.Variables.Data._data.data.game_answers.forEach(function(a){App.Variables.preload.loadFile({id:a.id,src:a.images},!1),App.Variables.preload.loadFile({id:"sound"+a.id,src:a.voice},!1)});var t=App.Variables.Data._data.data.game_load;App.Variables.preload.loadFile({id:t.id,src:t.images},!1),App.Variables.Data._data.data.game_background_music.forEach(function(a){App.Variables.preload.loadFile({id:a.id,src:a.voice},!1)}),App.Variables.preload.load()}function runClick(){var a=Number($(this).attr("index"));if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(ishover[a]=!0),ishover[a]){$(".run").unbind("click"),$(".btn-fail").unbind("click");for(var e=0;e<3;e++)ishover[e]=!1;App.Services.playSound(App.Variables.Data._data.data.game_background_music[2].id),App.Variables.figure.getNumbByPx("left"),$(this).addClass("bg--true");var i=$(this).children("p");i.active(0),App.Variables.figure.hasClass("started")&&App.Variables.figure.removeClass("started"),App.Variables.figure.hasClass("moving")||App.Variables.figure.addClass("moving");for(var t=1;t<=App.Variables.map.box;t++)if(t==App.Variables.map.count_box){$(".moving").css("animation-name","moving"+App.Variables.map.count_box),App.Variables.map.count_box++;break}App.Variables.map.bg=$(".bg--map"),App.Variables.map.bg.hasClass("wrapper--run")||App.Variables.map.bg.addClass("wrapper--run");var r=App.Variables.map.bg.getNumbByPx("width");App.Variables.map.count_box<10&&(l=r/App.Variables.map.box*-App.Variables.map.count_box+App.Variables.map.count_box*(App.Variables.screen/App.Variables.map.box),$(".wrapper--run").css("transform","translate("+l+"px,0)")),App.Variables.N--,App.Variables.map.count_box<=10&&0==App.Variables.N&&setTimeout(function(){App.Services.UpdateAnswer(App.Variables.Data._listR,App.Variables.Data._listW)},1e3),App.Variables.figure.one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(a){if(App.Variables.map.count_box>10){var e=App.Services.GetObjectFromUrl();e.point=10*(App.Variables.map.count_box-1),App.Services.sendMessage("exerciseid="+e.exerciseid+"&point="+e.point),App.Http.postHeaders(App.Constants.upPoint,e,function(a){App.Log.w(a,"upPoint:SUCCESS")},function(a){App.Log.w(a,"upPoint:ERR")}),$(".img-win p").children("span").text(e.point),App.Variables.figure.removeClass("moving"),App.Variables.figure.addClass("win"),$(".bg--question").disable(),$(".bg--excellent").active(1),App.Services.playSound(App.Variables.Data._data.data.game_background_music[4].id),App.Services.getDataRes(function(a){App.Variables.Data._data=a,App.Services.UpdateQuestion(App.Variables.Data._data)},function(a){alert("Can't load data simple!")}),App.Log.w(App.Variables.map.count_box-1,"điểm chơi"),App.Variables.map.count_box=1}i.disable()})}else{null!=mainsound&&mainsound.stop(),ishover[a]=!0;var n=$(this).children("p").attr("attr");null!=App.Variables.bg_sound&&(App.Variables.bg_sound.stop(),App.Variables.bg_sound=null),App.Services.playSound("sound"+n,function(a){App.Variables.bg_sound=a,a.on("complete",handleComplete,this)})}}function btnFailClick(){null!=mainsound&&mainsound.stop();var a=Number($(this).attr("index"));if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||(ishover[a]=!0),ishover[a]){$(".run").unbind("click"),$(".btn-fail").unbind("click");for(let a=0;a<3;a++)ishover[a]=!1;var t=App.Services.GetObjectFromUrl();t.point=10*(App.Variables.map.count_box-1),App.Services.sendMessage("exerciseid="+t.exerciseid+"&point="+t.point),App.Http.postHeaders(App.Constants.upPoint,t,function(a){App.Log.w(a,"upPoint:SUCCESS")},function(a){App.Log.w(a,"upPoint:ERR")}),$(".img-fail p").children("span").text(t.point),App.Services.playSound(App.Variables.Data._data.data.game_background_music[3].id),n=App.Variables.figure.getNumbByPx("left"),i=$(this).children("p"),e=$(this),e.addClass("bg--false"),i.active(),App.Variables.figure.hasClass("fail")||(App.Variables.figure.removeClass("started"),App.Variables.figure.removeClass("moving"),App.Variables.figure.addClass("fail"),$(".fail.player").css("left",n+"px")),App.Variables.figure.one("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd",function(a){$(".bg--question").disable(),$(".bg--fail").active(0),e.removeClass("bg--false"),i.disable(),$(this).unbind("animationend webkitAnimationEnd oAnimationEnd MSAnimationEnd")}),setTimeout(function(){App.Services.UpdateAnswer(App.Variables.Data._listR,App.Variables.Data._listW)},1e3)}else{null!=mainsound&&mainsound.stop(),ishover[a]=!0;var r=$(this).children("p").attr("attr");null!=App.Variables.bg_sound&&(App.Variables.bg_sound.stop(),App.Variables.bg_sound=null),App.Services.playSound("sound"+r,function(a){App.Variables.bg_sound=a,a.on("complete",handleComplete,this)})}}function mobileClick(){}function initAll(){App.Services.UpdateLearn();var a=$(".btn-play");a.length>0&&(a.click(function(){null!=mainsound&&mainsound.stop(),clearInterval(App.Variables.setInterval.event_listen),App.Services.playSound(App.Variables.Data._data.data.game_background_music[1].id),App.Services.getDataRes(function(a){App.Variables.Data._data=a,App.Variables.rnd=App.Services.getNumberRandomBetween(a.data.game_answers.length-1,0),App.Services.UpdateQuestion(App.Variables.Data._data)},function(a){alert("Can't load data simple!")}),App.Variables.figure.removeClass("win"),App.Variables.figure.removeClass("moving"),App.Variables.figure.removeClass("fail"),$(".bg--play").disable(),$(".bg--fail").disable(),$(".bg--excellent").disable(),$(".bg--learn").disable(),$(".bg--map").active(0),App.Variables.figure.hasClass("started")||(App.Variables.figure.addClass("started"),App.Variables.map.count_box=1,App.Variables.figure.css("left","-150px")),$(".bg--question").active(1),$(".bg--map").css("transform","translate(0,0)")}),setCss()),$(".btn-learn").click(function(){null!=mainsound&&mainsound.stop(),App.Services.playSound(App.Variables.Data._data.data.game_background_music[1].id),$(".bg--learn").active(1),$(".bg--fail").disable(),$(".bg--play").disable(),$(".bg--excellent").disable()}),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||App.Variables.question.mouseenter(function(){var a=$(this).children("p").attr("attr");null!=App.Variables.bg_sound&&App.Variables.bg_sound.stop(),App.Services.playSound("sound"+a,function(a){App.Variables.bg_sound=a,a.on("complete",handleComplete,this)})}),App.Variables.learn_item=$(".bg--learn__item"),App.Variables.learn_item.mouseenter(function(){clearInterval(App.Variables.setInterval.event_listen);var a=$(this).children("p").attr("attr");null!=App.Variables.bg_sound&&App.Variables.bg_sound.stop(),App.Services.playSound("sound"+a,function(a){App.Variables.bg_sound=a,a.on("complete",handleComplete,this)})}),$(".btn-sound").click(function(){var a=0;$(".bg--learn__list-item").scrollTop(0);var e=App.Variables.learn_item[0].children[1].getAttribute("attr");App.Services.playSound("sound"+e,function(a){App.Variables.setInterval.time=a.getDuration()||1,App.Log.w(App.Variables.setInterval.time)}),App.Variables.learn_item.removeClass("bg--learn__hover"),$(".bg--learn__item:eq("+a+")").addClass("bg--learn__hover");var i=$(".bg--learn__list-item .col-25").getNumbByPx("height"),t=0;null!=App.Variables.setInterval.event_listen&&clearInterval(App.Variables.setInterval.event_listen),App.Variables.setInterval.event_listen=setInterval(function(){if(a<App.Variables.learn_item.length-1){++a%4==0&&(t+=i,$(".bg--learn__list-item").scrollTop(t));var e=App.Variables.learn_item[a].children[1].getAttribute("attr");App.Services.playSound("sound"+e,function(a){App.Variables.setInterval.time=a.getDuration()||1}),App.Variables.learn_item.removeClass("bg--learn__hover"),$(".bg--learn__item:eq("+a+")").addClass("bg--learn__hover")}else $(".bg--learn__item").removeClass("bg--learn__hover"),t=0},App.Variables.setInterval.time+1e3)}),$(".btn-sound-repeat").click(function(){clearInterval(App.Variables.setInterval.event_listen);var a=$(".bg--learn__list-item .col-25").getNumbByPx("height");if(App.Variables.sound.count_sound<App.Variables.learn_item.length){App.Variables.sound.count_sound%4==0&&$(".bg--learn__list-item").scrollTop(App.Variables.sound.count_sound/4*a);var e=App.Variables.learn_item[App.Variables.sound.count_sound].children[1].getAttribute("attr");App.Services.playSound("sound"+e),App.Log.w(e),App.Variables.learn_item.removeClass("bg--learn__hover"),$(".bg--learn__item:eq("+App.Variables.sound.count_sound+")").addClass("bg--learn__hover"),App.Variables.sound.count_sound++}else App.Variables.sound.count_sound=0,$(".bg--learn__list-item").scrollTop(0)}),$(".btn-close").click(function(){App.Services.playSound(App.Variables.Data._data.data.game_background_music[1].id),App.Services.playSound(App.Variables.Data._data.data.game_background_music[0].id,function(a){mainsound=a}),$(".bg--play").active(1),$(".bg--learn").disable(),$(".bg--fail").disable(),$(".bg--excellent").disable(),clearInterval(App.Variables.setInterval.event_listen)}),App.Variables.load.process.css("animation-name","load"),App.Variables.load.process.one("animationstart mozAnimationStart webkitAnimationStart oAnimationStart MSAnimationStart",function(){App.Log.w("animationstart :start load"),clearInterval(App.Variables.setInterval.load_percent);var a=0;App.Variables.setInterval.load_percent=setInterval(function(){a>100&&clearInterval(App.Variables.setInterval.load_percent),App.Variables.load.span.text("loading... "+a+++"%")},98)})}function setCss(){$(".bg--map").css("background","url("+App.Services.getUrlById(App.Variables.Data._data.data.game_background[3].images)+") no-repeat"),$(".list-box li").css("background","url("+App.Services.getUrlById(App.Variables.Data._data.data.game_box.images)+") no-repeat top center"),$(".bg--question__item").css("background","url("+App.Services.getUrlById(App.Variables.Data._data.data.game_questionbox.images)+") no-repeat center center"),$(".btn-play img").attr("src",App.Services.getUrlById(App.Variables.Data._data.data.game_background[1].images)),$(".btn-learn img").attr("src",App.Services.getUrlById(App.Variables.Data._data.data.game_background[2].images)),$(".bg--fail__box").css("background","url("+App.Services.getUrlById(App.Variables.Data._data.data.game_background[4].images)+") no-repeat top center"),$(".bg--excellent__box").css("background","url("+App.Services.getUrlById(App.Variables.Data._data.data.game_background[5].images)+") no-repeat top center"),$(".bg--learn__box").css("background","url("+App.Variables.Data._data.data.game_background[6].images+") no-repeat top center");var a=App.Variables.Data._data.data.game_character,e=":root{--fail1 : url('"+a[0].images+"') no-repeat;--fail2 : url('"+a[1].images+"') no-repeat;--fail3 : url('"+a[2].images+"') no-repeat;--fail4 : url('"+a[3].images+"') no-repeat;--jump5 : url('"+a[4].images+"') no-repeat top center;--jump6 : url('"+a[5].images+"') no-repeat top center;--jump7 : url('"+a[6].images+"') no-repeat top center;--jump8 : url('"+a[7].images+"') no-repeat top center;--win9 : url('"+a[8].images+"');}";$("#var").html(e)}function handleComplete(){App.Variables.bg_sound=null}App.Services.getDataRes(function(a){App.Variables.isStartAll||(App.Variables.Data._data=a,preloadResource(),App.Variables.isStartAll=!0)},function(a){alert("Can't load data simple!")}),App.Services.bindEvent(window,"message",function(a){messageFromIframe=a.data}),$(window).bind("resize load",function(){$(window).width()<=1366&&($(window).width()/$(window).height()>996/561?($("#wrapper").scale($(window).height()/561),$("#wrapper").css("left",($(window).width()-$("#wrapper").width()*$(window).height()/561)/2)):$("#wrapper").scale($(window).width()/App.Variables.screen))});var a={id:" 1",name:"thach",name2:[],name3:{},name4:1};